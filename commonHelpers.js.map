{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst apiKey = '42006022-41a20d969efbb704c546dcbcd';\nconst searchForm = document.getElementById('search-form');\nconst searchInput = document.getElementById('search-input');\nconst loadingIndicator = document.getElementById('loading-indicator');\nconst galleryContainer = document.getElementById('gallery-container');\nconst loadMoreBtn = document.getElementById('load-more');\nlet searchTerm = '';\nlet page = 1;\nlet totalHits = 0;\n\nsearchForm.addEventListener('submit', handleSearch);\n\nloadMoreBtn.innerText = 'Load more';\nloadMoreBtn.classList.add('hidden');\nloadMoreBtn.addEventListener('click', handleLoadMore);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  searchTerm = searchInput.value.trim();\n\n  if (searchTerm === '') {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search term.',\n    });\n    return;\n  }\n\n  page = 1;\n  showLoadingIndicator();\n  clearGallery();\n\n  try {\n    const responseData = await fetchImages();\n    if (responseData.hits.length === 0) {\n      handleNoResults();\n    } else {\n      totalHits = responseData.totalHits;\n      updateGallery(responseData.hits);\n      showLoadMoreButton(responseData.hits.length);\n    }\n  } catch (error) {\n    console.error('Error fetching data:', error);\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred while fetching data. Please try again.',\n    });\n  } finally {\n    hideLoadingIndicator();\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n  showLoadingIndicator();\n\n  fetchImages()\n    .then((responseData) => {\n      if (responseData.hits.length === 0) {\n        handleNoResults();\n      } else {\n        totalHits = responseData.totalHits;\n        updateGallery(responseData.hits);\n        showLoadMoreButton(responseData.hits.length);\n        smoothScrollToGallery(responseData.hits.length);\n      }\n    })\n    .catch((error) => {\n      console.error('Error fetching data:', error);\n      iziToast.error({\n        title: 'Error',\n        message: 'An error occurred while fetching data. Please try again.',\n      });\n    })\n    .finally(() => {\n      hideLoadingIndicator();\n    });\n}\n\nfunction showLoadMoreButton(imagesCount) {\n  if (totalHits > page * 40 && imagesCount > 0) {\n    loadMoreBtn.style.display = 'block';\n  } else {\n    loadMoreBtn.style.display = 'none';\n    if (totalHits <= page * 40) {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        backgroundColor: '#03a9f4',\n        titleColor: '#FFFFFF',\n        messageColor: '#FFFFFF',\n      });\n    }\n  }\n}\n\nfunction smoothScrollToGallery(imagesCount) {\n  const galleryItemHeight = document.querySelector('.gallery-item').getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: galleryItemHeight * Math.min(2, imagesCount),\n    behavior: 'smooth',\n  });\n}\n\nfunction fetchImages() {\n  const perPage = 40;\n  return axios.get(\n    `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\n      searchTerm\n    )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`\n  ).then(response => response.data);\n}\n\nfunction showLoadingIndicator() {\n  loadingIndicator.classList.remove('hidden');\n}\n\nfunction hideLoadingIndicator() {\n  loadingIndicator.classList.add('hidden');\n}\n\nfunction handleNoResults() {\n  iziToast.info({\n    message: 'Sorry, there are no images matching your search query. Please try again.',\n    position: 'topRight',\n    color: '#EF4040',\n    progressBarColor: '#B51B1B',\n    messageColor: '#FAFAFB',\n    icon: './img/bi_x-octagon.svg',\n  });\n}\n\nfunction clearGallery() {\n  galleryContainer.innerHTML = '';\n}\n\nfunction updateGallery(images) {\n  const lightbox = new SimpleLightbox('.gallery-item a');\n\n  images.forEach((image) => {\n    const galleryItem = document.createElement('div');\n    galleryItem.classList.add('gallery-item');\n\n    const imageLink = document.createElement('a');\n    imageLink.href = image.largeImageURL;\n\n    const imageElement = document.createElement('img');\n    imageElement.src = image.webformatURL;\n    imageElement.alt = image.tags;\n    imageElement.title = image.tags;\n\n    const imageDesc = document.createElement('ul');\n    imageDesc.classList.add('image-desc');\n\n    const likesDesc = document.createElement('li');\n    likesDesc.classList.add('image-desc-item');\n    likesDesc.innerHTML = `<p>Likes</p><p>${image.likes}</p>`;\n\n    const viewsDesc = document.createElement('li');\n    viewsDesc.classList.add('image-desc-item');\n    viewsDesc.innerHTML = `<p>Views</p><p>${image.views}</p>`;\n\n    const commentsDesc = document.createElement('li');\n    commentsDesc.classList.add('image-desc-item');\n    commentsDesc.innerHTML = `<p>Comments</p><p>${image.comments}</p>`;\n\n    const downloadsDesc = document.createElement('li');\n    downloadsDesc.classList.add('image-desc-item');\n    downloadsDesc.innerHTML = `<p>Downloads</p><p>${image.downloads}</p>`;\n\n    imageDesc.appendChild(likesDesc);\n    imageDesc.appendChild(viewsDesc);\n    imageDesc.appendChild(commentsDesc);\n    imageDesc.appendChild(downloadsDesc);\n\n    imageLink.appendChild(imageElement);\n    galleryItem.appendChild(imageLink);\n    galleryItem.appendChild(imageDesc);\n\n    galleryContainer.appendChild(galleryItem);\n  });\n\n  lightbox.refresh();\n}\n"],"names":["apiKey","searchForm","searchInput","loadingIndicator","galleryContainer","loadMoreBtn","searchTerm","page","totalHits","handleSearch","handleLoadMore","event","iziToast","showLoadingIndicator","clearGallery","responseData","fetchImages","handleNoResults","updateGallery","showLoadMoreButton","error","hideLoadingIndicator","smoothScrollToGallery","imagesCount","galleryItemHeight","axios","response","images","lightbox","SimpleLightbox","image","galleryItem","imageLink","imageElement","imageDesc","likesDesc","viewsDesc","commentsDesc","downloadsDesc"],"mappings":"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"}